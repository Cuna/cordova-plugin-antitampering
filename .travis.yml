sudo: false

language: objective-c
os: osx
osx_image: xcode7.3
node_js:
  - "6.9.5"

cache: false

before_install:
  - export LANG=en_US.UTF-8
  - brew update

install:
  - npm install

before_script:
  - npm test

script:
  - wget http://dl.google.com/android/android-sdk_r24.4-macosx.zip
  - tar -xvf android-sdk_r24.4-macosx.zip

  - echo y | ./android-sdk-macosx/tools/android update sdk --no-ui --all --filter platform-tools
  - echo y | ./android-sdk-macosx/tools/android update sdk --no-ui --all --filter build-tools-23.0.2
  - echo y | ./android-sdk-macosx/tools/android update sdk --no-ui --all --filter android-23
  - echo y | ./android-sdk-macosx/tools/android update sdk --no-ui --all --filter extra-android-support
  - echo y | ./android-sdk-macosx/tools/android update sdk --no-ui --all --filter extra-android-m2repository
  - echo y | ./android-sdk-macosx/tools/android update sdk --no-ui --all --filter extra-google-m2repository

  - ls -la

  - export ANDROID_HOME=/Users/travis/build/duddu/cordova-plugin-antitampering/android-sdk-macosx
  - export PATH=${PATH}:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools:$ANDROID_HOME/build-tools/23.0.2

  - npm install -g cordova

  - cordova create hello com.example.hello HelloWorld
  - cd hello
  - cordova platform add android@5.2.2 --save
  - cordova plugin add ../ --variable ENABLE_CORDOVA_CALLBACK=true --save
  - cordova plugin list

  - cordova build android
